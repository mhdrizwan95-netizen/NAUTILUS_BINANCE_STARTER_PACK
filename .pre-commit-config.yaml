repos:
- repo: https://github.com/pre-commit/pre-commit-hooks
  rev: v4.6.0
  hooks:
    - id: check-added-large-files
      args: ["--maxkb=25600"]
    - id: end-of-file-fixer
      exclude: &generated-files-regex |
        (?x)(
          ^\.hypothesis/
          |^frontend/(build|playwright-report|test-results)/
          |^backtests/results/
          |^STATE_UI_LOOP_
        )
    - id: trailing-whitespace
      exclude: *generated-files-regex
    - id: detect-private-key
    - id: check-yaml
    - id: check-merge-conflict
    - id: mixed-line-ending
- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.6.9
  hooks:
    - id: ruff
      args: ["--fix"]
    - id: ruff-format
- repo: https://github.com/psf/black-pre-commit-mirror
  rev: 24.8.0
  hooks:
    - id: black
- repo: local
  hooks:
    - id: mypy-entrypoints
      name: mypy (entrypoints only)
      entry: bash -c 'python3 -m mypy --install-types --non-interactive engine/app.py ops/ui_api.py services/backtester/app/main.py services/data_ingester/app/main.py services/ml_service/app/main.py services/param_controller/app/main.py'
      language: system
      pass_filenames: false
- repo: https://github.com/trailofbits/pip-audit
  rev: v2.7.3
  hooks:
    - id: pip-audit
      args: ["-r", "requirements.txt", "-r", "requirements-dev.txt"]
- repo: https://github.com/pre-commit/mirrors-prettier
  rev: v3.0.0
  hooks:
    - id: prettier
      files: ^frontend/
      additional_dependencies:
        - prettier@3.3.3
- repo: https://github.com/pre-commit/mirrors-eslint
  rev: v9.14.0
  hooks:
    - id: eslint
      files: ^frontend/src/.*\.(ts|tsx)$
      args: ["--max-warnings=0"]
      additional_dependencies:
        - eslint@9.14.0
        - "@typescript-eslint/parser@8.11.0"
        - "@typescript-eslint/eslint-plugin@8.11.0"
        - eslint-config-prettier@9.1.0
        - eslint-plugin-jsx-a11y@6.9.0
        - eslint-plugin-import@2.30.0
- repo: https://github.com/PyCQA/bandit
  rev: 1.7.9
  hooks:
    - id: bandit
      args:
        [
          "-c",
          "bandit.yaml",
          "-q",
          "-n",
          "1",
          "-r",
          "engine",
          "ops",
          "services",
          "shared",
          "-x",
          "tests,docs,frontend",
        ]
      pass_filenames: false
- repo: https://github.com/Yelp/detect-secrets
  rev: v1.5.0
  hooks:
    - id: detect-secrets
      args: ["--baseline", ".secrets.baseline"]
