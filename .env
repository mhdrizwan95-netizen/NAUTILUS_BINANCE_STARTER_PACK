# ==== ENGINE (shared) ====
TRADING_ENABLED=true
TRADE_SYMBOLS=*
MIN_NOTIONAL_USDT=5
# Loosen per-order cap to allow larger trades if signals fire
MAX_NOTIONAL_USDT=1000
# Allow higher throughput for strategy-driven orders
MAX_ORDERS_PER_MIN=120
DUST_THRESHOLD_USD=2
# Loosen exposure rails to avoid early blocking on small accounts
EXPOSURE_CAP_SYMBOL_USD=2000
EXPOSURE_CAP_TOTAL_USD=10000
# Relax venue error breaker so transient testnet/API hiccups don't pause trading
VENUE_ERROR_BREAKER_PCT=100
VENUE_ERROR_WINDOW_SEC=30
ANN_ENABLED=true
EVENT_BREAKOUT_ENABLED=true
EVENT_BREAKOUT_DRY_RUN=true
EVENT_BREAKOUT_HALF_SIZE_MINUTES=5
EVENT_BREAKOUT_SIZE_USD=20

# ==== MEME SENTIMENT STRATEGY ====
MEME_SENTIMENT_ENABLED=true
MEME_SENTIMENT_DRY_RUN=true
MEME_SENTIMENT_RISK_PCT=0.006
MEME_SENTIMENT_STOP_PCT=0.11
MEME_SENTIMENT_TP_PCT=0.32
MEME_SENTIMENT_TRAIL_PCT=0.18
MEME_SENTIMENT_FALLBACK_EQUITY=2500
MEME_SENTIMENT_NOTIONAL_MIN=35
MEME_SENTIMENT_NOTIONAL_MAX=180
MEME_SENTIMENT_MIN_PRIORITY=0.88
MEME_SENTIMENT_MIN_SCORE=1.8
MEME_SENTIMENT_MIN_MENTIONS=25
MEME_SENTIMENT_MIN_VELOCITY=1.1
MEME_SENTIMENT_MAX_CHASE_PCT=0.65
MEME_SENTIMENT_MAX_SPREAD_PCT=0.05
MEME_SENTIMENT_COOLDOWN_SEC=900
MEME_SENTIMENT_LOCK_SEC=600
MEME_SENTIMENT_DENY_KEYWORDS=rug,rugpull,scam,honeypot,airdrop
MEME_SENTIMENT_SOURCES=twitter_firehose,dex_whale,binance_listings
MEME_SENTIMENT_QUOTES=USDT,USDC
MEME_SENTIMENT_METRICS_ENABLED=true
MEME_SENTIMENT_PUBLISH_TOPIC=strategy.meme_sentiment_trade

# ==== LISTING SNIPER ====
LISTING_SNIPER_ENABLED=true
LISTING_SNIPER_DRY_RUN=true
LISTING_SNIPER_RISK_PCT=0.0075
LISTING_SNIPER_STOP_PCT=0.12
LISTING_SNIPER_MIN_NOTIONAL_USD=30
LISTING_SNIPER_MAX_NOTIONAL_USD=150
LISTING_SNIPER_ENTRY_DELAY_SEC=12
LISTING_SNIPER_ENTRY_TIMEOUT_SEC=180
LISTING_SNIPER_MAX_CHASE_PCT=0.35
LISTING_SNIPER_MAX_SPREAD_PCT=0.04
LISTING_SNIPER_COOLDOWN_SEC=900
LISTING_SNIPER_MAX_PARALLEL=2
LISTING_SNIPER_FORWARD_LEGACY=true
LISTING_SNIPER_METRICS_ENABLED=true
LISTING_SNIPER_DEX_BRIDGE_ENABLED=true

# ==== AIRDROP / PROMO WATCHER ====
AIRDROP_PROMO_ENABLED=1
AIRDROP_PROMO_DRY_RUN=true
AIRDROP_PROMO_RISK_PCT=0.004
AIRDROP_PROMO_FALLBACK_EQUITY=2500
AIRDROP_PROMO_DEFAULT_NOTIONAL=60
AIRDROP_PROMO_NOTIONAL_MIN=30
AIRDROP_PROMO_NOTIONAL_MAX=200
AIRDROP_PROMO_MIN_REWARD=10
AIRDROP_PROMO_MIN_PRIORITY=0.75
AIRDROP_PROMO_MAX_SPREAD_PCT=0.05
AIRDROP_PROMO_COOLDOWN_SEC=5400
AIRDROP_PROMO_KEYWORDS=airdrop,promotion,launchpool,launchpad,bonus,voucher,campaign,earn,promo
AIRDROP_PROMO_DENY_KEYWORDS=scam,phishing
AIRDROP_PROMO_ALLOWED_SOURCES=binance_listings,twitter_firehose
AIRDROP_PROMO_METRICS_ENABLED=true
AIRDROP_PROMO_PUBLISH_TOPIC=strategy.airdrop_promo_participation

# ==== BINANCE ====
BINANCE_MODE=usdm
# Inject via secrets manager or /run/secrets mounts; keep git copies empty.
BINANCE_API_KEY=
BINANCE_API_SECRET=
# Point all components at Futures base
BINANCE_FUTURES_BASE=https://fapi.binance.com
BINANCE_USDM_WS_BASE=wss://fstream.binance.com/stream
AUTO_TOPUP_ENABLED=true
MIN_FUT_BAL_USDT=300
TOPUP_CHUNK_USDT=500
AUTO_TOPUP_PERIOD_SEC=45

# ==== OPS / DASH ====
# OPS serves the dashboard at /pnl_dashboard.html
OPS_PORT=8002
OPS_WORKERS=2
ENGINE_ENDPOINTS=http://engine_binance:8003
OPS_API_TOKEN=test-ops-token
# optional file path left blank for local run
OPS_API_TOKEN_FILE=

# ==== METRICS ====
ENGINE_METRICS_PORT=9103
OPS_METRICS_PORT=9102

# ==== HTTP Defaults ====
BINANCE_RECV_WINDOW=5000
BINANCE_API_TIMEOUT=15
DEMO_USDM_BASE=https://testnet.binancefuture.com
DEMO_COINM_BASE=https://dapi.binance.com


# ==== EXECUTOR PACING (AGGRESSIVE anti-storm settings) ====
EXEC_INTERVAL_SEC=12
EXEC_JITTER=0.40
PROBE_COOLDOWN_SEC=45
MAX_PARALLEL_ORDERS=1
# Note: Avoid overriding engine MAX_ORDERS_PER_MIN via global .env.
# The engine uses MAX_ORDERS_PER_MIN for RiskRails; executor has its own setting
# in docker-compose. Keep this executor-specific knob namespaced to prevent
# accidental throttling of the engine.
EXEC_MAX_ORDERS_PER_MIN=3
RETRY_BASE_MS=600
RETRY_BACKOFF=2.0
RETRY_MAX_SEC=20

# ==== SYMBOL FEED (screener-driven breadth) ====
USE_SYMBOL_FEED=true
SYMBOL_FEED_URL=http://hmm_screener:8010/candidates
FALLBACK_SYMBOLS=BTCUSDT,ETHUSDT,BNBUSDT

# ==== PHYSICALLY BOUNDED EXECUTION (storms impossible) ====
# At most 5 symbols processed per round (expanded breadth, controlled pressure)
EXEC_SYMBOLS_PER_ROUND=5
# Circuit breaker: trip fast on 3 errors in 20s, cool down 3 min
EXEC_ERR_THRESHOLD=3
EXEC_ERR_WINDOW_SEC=20
EXEC_COOLDOWN_SEC=180

# ==== BINANCE BASE URLS (define to remove warnings) ====
BINANCE_SPOT_BASE=https://api.binance.com
DEMO_SPOT_BASE=https://testnet.binance.vision

# ==== STRATEGY (light probe trading) ====
# Enable the built-in MA crossover strategy with tiny notionals
STRATEGY_ENABLED=true
STRATEGY_DRY_RUN=true
MOMENTUM_ENABLED=true
MOMENTUM_DRY_RUN=true
STRATEGY_SYMBOLS=BTCUSDT,ETHUSDT
TREND_ENABLED=true
TREND_DRY_RUN=true
TREND_SYMBOLS=BTCUSDT,ETHUSDT
TREND_PRIMARY_FAST=10
TREND_PRIMARY_SLOW=40
TREND_SECONDARY_FAST=20
TREND_SECONDARY_SLOW=80
TREND_REGIME_FAST=15
TREND_REGIME_SLOW=60
TREND_RSI_LONG_MIN=48
TREND_RSI_LONG_MAX=80
TREND_RSI_EXIT=85
TREND_ATR_STOP_MULT=0.6
TREND_ATR_TARGET_MULT=1.2
TREND_COOLDOWN_BARS=0
TREND_AUTO_TUNE_ENABLED=true

# ==== SYMBOL SCANNER ====
SYMBOL_SCANNER_ENABLED=true
SYMBOL_SCANNER_UNIVERSE=BTCUSDT,ETHUSDT,BNBUSDT,ADAUSDT,DOTUSDT
SYMBOL_SCANNER_INTERVAL_SEC=300
SYMBOL_SCANNER_INTERVAL=1h
SYMBOL_SCANNER_LOOKBACK=60
SYMBOL_SCANNER_TOP_N=3
SYMBOL_SCANNER_MIN_VOLUME_USD=250000
SYMBOL_SCANNER_MIN_ATR_PCT=0.8
SYMBOL_SCANNER_WEIGHT_RET=0.5
SYMBOL_SCANNER_WEIGHT_TREND=0.3
SYMBOL_SCANNER_WEIGHT_VOL=0.2
SYMBOL_SCANNER_MIN_MINUTES_BETWEEN_RESELECT=30
STRATEGY_INTERVAL_SEC=30
STRATEGY_FAST=9
STRATEGY_SLOW=21
STRATEGY_QUOTE_USDT=25.0
SCREENER_AUTO_SCAN=true
SCREENER_SCAN_INTERVAL_SEC=45
SCREENER_SYMBOL_CAP=300
SCREENER_ROTATE=5
SCREENER_SCAN_JITTER=0.1

# ==== BRACKET GOVERNANCE ====
BRACKET_GOVERNOR_ENABLED=true

# --- SAFETY MODULES (ARM THESE) ---
STOP_VALIDATOR_ENABLED=true
STOP_VALIDATOR_REPAIR=true
STOP_VALIDATOR_GRACE_SEC=2
AUTO_CUTBACK_ENABLED=true
RISK_PARITY_ENABLED=true
DEPEG_GUARD_ENABLED=true
DEPEG_THRESHOLD_PCT=0.5
DEPEG_CONFIRM_WINDOWS=3
DEPEG_EXIT_RISK=false
FUNDING_GUARD_ENABLED=true
FUNDING_SPIKE_THRESHOLD=0.15
FUNDING_HEDGE_RATIO=0.00

# --- WS LISTENER (fills -> trade.fill) ---
EXEC_FILLS_LISTENER_ENABLED=true
WS_HEALTH_ENABLED=true
WS_DISCONNECT_ALERT_SEC=15

# --- HOUSEKEEPING ---
WARMUP_SEC=30
MIN_NOTIONAL_BLOCK_USD=20
TP_BPS=20.0
SL_BPS=30.0
ALLOW_STOP_AMEND=true

# ==== HMM guardrails (if using HMM policy) ====
# Lower confidence threshold and widen spread gate
MIN_CONF=0.50
MAX_SPREAD_BP=100.0
# Reduce global cooldown between flips to increase opportunities
COOLDOWN_MS=500
# Increase daily risk budget for HMM policy guardrails
DAY_RISK_USD=500

# ====== Telegram Notification =======
TELEGRAM_ENABLED=true
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=448249054
TELEGRAM_BRIDGE_ENABLED=true
TELEGRAM_FORCE_IPV4=true
HEALTH_TG_ENABLED=true # health pings
DIGEST_INTERVAL_MIN=1440 # daily digest (optional)

PYTHONLOGLEVEL=INFO

TRADE_SYMBOLS=*

# --- Conservative live rails (engine ignores RISK_*; keep as commented reference) ---
#RISK_MIN_NOTIONAL_USDT=5
#RISK_MAX_NOTIONAL_USDT=200
#RISK_MAX_ORDERS_PER_MIN=30
#RISK_EXPOSURE_CAP_SYMBOL_USD=400
#RISK_EXPOSURE_CAP_TOTAL_USD=1200
#RISK_VENUE_ERROR_BREAKER_PCT=20
#RISK_VENUE_ERROR_WINDOW_SEC=30

# --- Conservative risk (unprefixed) ---
MIN_NOTIONAL_USDT=5
MAX_NOTIONAL_USDT=200
MAX_ORDERS_PER_MIN=30
EXPOSURE_CAP_SYMBOL_USD=400
EXPOSURE_CAP_TOTAL_USD=1200
VENUE_ERROR_BREAKER_PCT=20
VENUE_ERROR_WINDOW_SEC=30

# --- WS â†’ Strategy tick bridge ---
BINANCE_WS_EMIT_TICKS=true
STRATEGY_TICKS_ENABLED=true

TRADE_SYMBOLS=BTCUSDT,ETHUSDT

LEVERAGE_DEFAULT=5
MARGIN_MODE=isolated

LEVERAGE_DEFAULT=5
MARGIN_MODE=isolated

# ===DEX Screener====
DEX_RPC_URL=https://bsc-dataseed.binance.org
DEX_ROUTER_ADDRESS=0x10ED43C718714eb63d5aA57B78B54704E256024E
DEX_STABLE_TOKEN=0x55d398326f99059fF775485246999027B3197955
DEX_WRAPPED_NATIVE=0xBB4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c
DEX_PRIVATE_KEY=
DEX_EXEC_ENABLED=false
DEX_FEED_ENABLED=true
DEX_WATCHER_ENABLED=true  # optional; defaults true
DEX_CHAIN_ID=56
DEX_CHAIN_WHITELIST=BSC,BASE
DEX_STATE_PATH=data/runtime/dex_positions.json
DEX_MAX_LIVE=1
DEX_SIZE_TIER_A=60
DEX_SIZE_TIER_B=30
DEX_STOP_LOSS_PCT=0.15
DEX_TP1_PCT=0.35
DEX_TP1_PORTION=0.45
DEX_TP2_PCT=0.65
DEX_TP2_PORTION=0.30
DEX_TRAIL_PCT=0.18
DEX_SLIPPAGE_BPS=90
DEX_MAX_SLIPPAGE_BPS=140
DEX_TAX_MAX_PCT=4
DEX_MIN_LIQ_USD=150000
DEX_TOP10_MAX_PCT=65
DEX_MAX_GAS_WEI=60000000000
DEX_GAS_LIMIT=450000
DEX_PRICE_ORACLE=dexscreener
DEX_WATCHER_POLL_SEC=6


# ==== OBSERVABILITY / GRAFANA ====
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=change-me
GF_SECURITY_ADMIN_PASSWORD__FILE=/run/secrets/grafana_admin_password

# --- Autonomy ---
STRATEGY_AUTORUN=true

BRACKET_GOVERNOR_ENABLED=true
