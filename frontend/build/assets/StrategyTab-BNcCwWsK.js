import{c as S,j as l,E as Q,o as e,q as ee,F as w,v as _,P as j,w as v,l as E,G as te,H as ae,z as y,C as oe,B as b,I as g}from"./index-DTayauxn.js";import{L as se,f as ne,B as re,u as ie,g as le,s as ce,h as de}from"./api-CNNmOJT6.js";import{S as ue}from"./separator-AMGiFk8T.js";import{P as fe,h as pe,R as ge,u as me,F as xe,D as he}from"./index-Czg2m92V.js";import{P as ve,D as je}from"./DynamicParamForm-CW-V2QC6.js";import{R as ye}from"./generateCategoricalChart-xSD5sOcd.js";import"./select-BIy1EetY.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Ne=S("settings-2",De);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Re=S("square",Ce);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],be=S("x",we);var N="Dialog",[A]=ee(N),[Se,f]=A(N),M=t=>{const{__scopeDialog:a,children:s,open:r,defaultOpen:n,onOpenChange:o,modal:c=!0}=t,u=l.useRef(null),p=l.useRef(null),[x,h]=Q({prop:r,defaultProp:n??!1,onChange:o,caller:N});return e.jsx(Se,{scope:a,triggerRef:u,contentRef:p,contentId:w(),titleId:w(),descriptionId:w(),open:x,onOpenChange:h,onOpenToggle:l.useCallback(()=>h(C=>!C),[h]),modal:c,children:s})};M.displayName=N;var T="DialogTrigger",_e=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=f(T,s),o=E(a,n.triggerRef);return e.jsx(j.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":O(n.open),...r,ref:o,onClick:v(t.onClick,n.onOpenToggle)})});_e.displayName=T;var P="DialogPortal",[Ee,$]=A(P,{forceMount:void 0}),L=t=>{const{__scopeDialog:a,forceMount:s,children:r,container:n}=t,o=f(P,a);return e.jsx(Ee,{scope:a,forceMount:s,children:l.Children.map(r,c=>e.jsx(_,{present:s||o.open,children:e.jsx(fe,{asChild:!0,container:n,children:c})}))})};L.displayName=P;var D="DialogOverlay",W=l.forwardRef((t,a)=>{const s=$(D,t.__scopeDialog),{forceMount:r=s.forceMount,...n}=t,o=f(D,t.__scopeDialog);return o.modal?e.jsx(_,{present:r||o.open,children:e.jsx(Ie,{...n,ref:a})}):null});W.displayName=D;var Pe=te("DialogOverlay.RemoveScroll"),Ie=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=f(D,s);return e.jsx(ge,{as:Pe,allowPinchZoom:!0,shards:[n.contentRef],children:e.jsx(j.div,{"data-state":O(n.open),...r,ref:a,style:{pointerEvents:"auto",...r.style}})})}),m="DialogContent",q=l.forwardRef((t,a)=>{const s=$(m,t.__scopeDialog),{forceMount:r=s.forceMount,...n}=t,o=f(m,t.__scopeDialog);return e.jsx(_,{present:r||o.open,children:o.modal?e.jsx(Oe,{...n,ref:a}):e.jsx(Fe,{...n,ref:a})})});q.displayName=m;var Oe=l.forwardRef((t,a)=>{const s=f(m,t.__scopeDialog),r=l.useRef(null),n=E(a,s.contentRef,r);return l.useEffect(()=>{const o=r.current;if(o)return pe(o)},[]),e.jsx(z,{...t,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:v(t.onCloseAutoFocus,o=>{o.preventDefault(),s.triggerRef.current?.focus()}),onPointerDownOutside:v(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&o.preventDefault()}),onFocusOutside:v(t.onFocusOutside,o=>o.preventDefault())})}),Fe=l.forwardRef((t,a)=>{const s=f(m,t.__scopeDialog),r=l.useRef(!1),n=l.useRef(!1);return e.jsx(z,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||s.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,n.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const c=o.target;s.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),z=l.forwardRef((t,a)=>{const{__scopeDialog:s,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:o,...c}=t,u=f(m,s),p=l.useRef(null),x=E(a,p);return me(),e.jsxs(e.Fragment,{children:[e.jsx(xe,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:o,children:e.jsx(he,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":O(u.open),...c,ref:x,onDismiss:()=>u.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(ke,{titleId:u.titleId}),e.jsx(Me,{contentRef:p,descriptionId:u.descriptionId})]})]})}),I="DialogTitle",G=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=f(I,s);return e.jsx(j.h2,{id:n.titleId,...r,ref:a})});G.displayName=I;var B="DialogDescription",U=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=f(B,s);return e.jsx(j.p,{id:n.descriptionId,...r,ref:a})});U.displayName=B;var H="DialogClose",V=l.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=f(H,s);return e.jsx(j.button,{type:"button",...r,ref:a,onClick:v(t.onClick,()=>n.onOpenChange(!1))})});V.displayName=H;function O(t){return t?"open":"closed"}var K="DialogTitleWarning",[st,X]=ae(K,{contentName:m,titleName:I,docsSlug:"dialog"}),ke=({titleId:t})=>{const a=X(K),s=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return l.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},Ae="DialogDescriptionWarning",Me=({contentRef:t,descriptionId:a})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${X(Ae).contentName}}.`;return l.useEffect(()=>{const n=t.current?.getAttribute("aria-describedby");a&&n&&(document.getElementById(a)||console.warn(r))},[r,t,a]),null},Te=M,$e=L,Le=W,We=q,qe=G,ze=U,Ge=V;function Be({...t}){return e.jsx(Te,{"data-slot":"dialog",...t})}function Ue({...t}){return e.jsx($e,{"data-slot":"dialog-portal",...t})}const Y=l.forwardRef(({className:t,...a},s)=>e.jsx(Le,{ref:s,"data-slot":"dialog-overlay",className:y("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a}));Y.displayName="DialogOverlay";function He({className:t,children:a,...s}){return e.jsxs(Ue,{"data-slot":"dialog-portal",children:[e.jsx(Y,{}),e.jsxs(We,{"data-slot":"dialog-content",className:y("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s,children:[a,e.jsxs(Ge,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(be,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Ve({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:y("flex flex-col gap-2 text-center sm:text-left",t),...a})}function Ke({className:t,...a}){return e.jsx(qe,{"data-slot":"dialog-title",className:y("text-lg leading-none font-semibold",t),...a})}function Xe({className:t,...a}){return e.jsx(ze,{"data-slot":"dialog-description",className:y("text-muted-foreground text-sm",t),...a})}const Z=l.memo(({data:t,color:a,trend:s})=>{const r=t.map((n,o)=>({value:n,index:o}));return e.jsx(ye,{width:"100%",height:"100%",children:e.jsx(se,{data:r,children:e.jsx(ne,{type:"monotone",dataKey:"value",stroke:a,strokeWidth:1.5,dot:!1,isAnimationActive:!1})})})});Z.displayName="MiniChart";function Ye(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(t)}function nt(){const[t,a]=l.useState([]),[s,r]=l.useState(!1),[n,o]=l.useState(null),[c,u]=l.useState(null),p=async()=>{r(!0);try{const i=await le();a(i)}catch(i){i instanceof Error&&g.error("Unable to load strategies",{description:i.message})}finally{r(!1)}};l.useEffect(()=>{p()},[]);const x=async i=>{o(i.id);try{await ce(i.id,i.params),g.success(`Started ${i.name}`),await p()}catch(d){d instanceof Error&&g.error("Failed to start strategy",{description:d.message})}finally{o(null)}},h=async i=>{o(i.id);try{await de(i.id),g("Strategy stopped",{description:i.name}),await p()}catch(d){d instanceof Error&&g.error("Failed to stop strategy",{description:d.message})}finally{o(null)}},C=l.useMemo(()=>t,[t]);return e.jsxs("div",{className:"mx-auto max-w-6xl space-y-4 p-6",children:[s&&t.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading strategies…"}):null,e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:C.map(i=>{const d=i.performance,R=d?.equitySeries?.length?d.equitySeries.at(-1).equity>=d.equitySeries[0].equity?"up":"down":"neutral",F=d?.equitySeries?.map(J=>J.equity)??[],k=d?.pnl??0;return e.jsxs(oe,{className:"flex flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-base font-semibold",children:i.name}),e.jsx(re,{variant:i.status==="running"?"secondary":i.status==="error"?"destructive":"outline",children:i.status.toUpperCase()})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.kind," • ",i.symbols.join(", ")]})]}),e.jsx("div",{className:"h-16 w-40",children:F.length>1?e.jsx(Z,{data:F,color:R==="up"?"#10b981":R==="down"?"#ef4444":"#6366f1",trend:R}):e.jsx("div",{className:"flex h-full items-center justify-center text-xs text-muted-foreground",children:"No data"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"PnL"}),e.jsx("p",{className:k>=0?"text-emerald-400":"text-red-400",children:Ye(k)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Win Rate"}),e.jsx("p",{children:d?.winRate!==void 0?`${(d.winRate*100).toFixed(1)}%`:"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sharpe"}),e.jsx("p",{children:d?.sharpe!==void 0?d.sharpe.toFixed(2):"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Drawdown"}),e.jsx("p",{children:d?.drawdown!==void 0?`${(d.drawdown*100).toFixed(1)}%`:"—"})]})]}),e.jsx(ue,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.status!=="running"?e.jsxs(b,{size:"sm",onClick:()=>x(i),disabled:n===i.id,className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"Start"]}):e.jsxs(b,{size:"sm",variant:"destructive",onClick:()=>h(i),disabled:n===i.id,className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Stop"]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>u(i),className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Configure"]})]})]},i.id)})}),e.jsx(Be,{open:c!==null,onOpenChange:i=>!i&&u(null),children:e.jsxs(He,{className:"max-w-xl",children:[c&&e.jsxs(Ve,{children:[e.jsxs(Ke,{children:["Configure ",c.name]}),e.jsx(Xe,{children:"Update parameters and apply instantly. Changes propagate on the next signal tick."})]}),c&&e.jsx(je,{schema:c.paramsSchema,initial:c.params,submitLabel:"Save",onSubmit:async i=>{o(c.id);try{await ie(c.id,i),g.success("Strategy updated"),u(null),await p()}catch(d){d instanceof Error&&g.error("Failed to update strategy",{description:d.message})}finally{o(null)}}})]})})]})}export{nt as StrategyTab};
